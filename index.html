<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Better Way :: Workflow 2.1.2</title>
    <script src="script/workflow.js"></script>
    <script src="script/workflowUI.js"></script>
    <script src="script/app.js"></script>
    <link rel="stylesheet" href="style/main.css">

    <script>
        function init() {
            window.addEventListener("keydown", function(event) {
                if (event.srcElement != document.body) return;
                event.preventDefault();
                switch(event.keyCode) {
                    case 48: // 0 (10th item)
                    var sel = document.getElementById("selLoadLocal");
                        sel.selectedIndex = 9; // 10th item
                        app.loadLocal();
                        break;
                    case 49: //1-9 flow load
                    case 50:
                    case 51:
                    case 52:
                    case 53:
                    case 54:
                    case 55:
                    case 56:
                    case 57:
                        var sel = document.getElementById("selLoadLocal");
                        sel.selectedIndex = (event.keyCode - 49);
                        app.loadLocal();
                        break;
                    case 27: // escape key
                        WF.pickedItem = null;
                        app.cancelAction();
                        app.hideEditor();
                        WF.drawCanvas();
                        break;
                    case 37: // left arrow
                        if (event.shiftKey) app.shiftAll("L");
                        break;
                    case 39: // right arrow
                        if (event.shiftKey) app.shiftAll("R");
                        break;
                    case 38: // up arrow
                        if (event.shiftKey) app.shiftAll("U");
                        break;
                    case 40: // down arrow
                        if (event.shiftKey) app.shiftAll("D");
                        break;
                    case 67: // c (Center items)
                        if (event.shiftKey) app.shiftCenter();
                        break;
                    case 191: // forward slash
                        app.toggleMode();
                        break;
                    case 84: // t (Edit title)
                        app.popupWFTitle();
                        break;
                    case 32: // space bar
                        app.toggleComplete();
                        break;
                    case 8: // backspace
                    case 46: // delete
                        app.askToDeleteItem();
                        break;
                    case 13: // enter key
                        break;
                    case 65: // a (add item)
                        app.askToAddNewItem();
                        break;
                    case 66: // b (Block link)
                        app.askToAddLink("blocks");
                        break;
                    case 69: // e (Edit item)
                        //app.toggleMode("design");
                        app.editItem();
                        break;
                    case 83: // s (item shape)
                        app.cycleItemShape();
                        break;
                    case 89: // y (bloked bY link)
                        app.askToAddLink("blockby");
                        break;
                    case 78: // n (find / pick next unblocked)
                        app.pickNext();
                        break;
                    case 82: // r (reset)
                        app.resetFlow();
                        break;
                    default:
                        //console.log(event.keyCode + " pressed");
                }
            });
            app.updateLocalStorage();
            initWF();
            app.loadLocal();
        }
    </script>
</head>
<body onload='init()'>
    <table class='directionRosette' onclick='app.clickShift(event)'>
        <tr><td></td><td></td><td></td></tr>
        <tr><td></td><td></td><td></td></tr>
        <tr><td></td><td></td><td></td></tr>
    </table>
    <div id='canvasContainer'>

    </div>
    <div id='formContainer'>
        <div style='position:absolute;top:.2em;right:.5em;text-align:right;'>
        <span class='anchor' style='font-weight:bold' onclick='app.toggleMode()' id='locModeName'>work</span>
        </div>
        <form id='frmWF' style='width:100%' onsubmit='return false;'>
            <table id='topForm' class='form' style='width:360px; margin:0 auto;'>
                <tr><th ondblclick="app.resetFlow()" style='vertical-align:top; width:38px'>&nbsp;Title:</th>
                    <td style='vertical-align:top;'>
                        <input style='width:220px;border:0; background:transparent' onkeyup='app.updateWFTitle(this)' id='wf_title' name='wf_title'>
                        <button onclick='app.askToLoadFlow()'>&hellip;</button>
                    </td>
                </tr>
            </table>
            <hr>
            <span id='itemEditor' style='display:none'>
            <table class='form'>
                <tr><th class='anchor' onclick='app.mode="design";app.editItem()'>Item&nbsp;Title:</th><td>
                    <span id='item_title'></span>
                </td></tr>
                <tr><th style='vertical-align:top'>Complete:</th><td style='vertical-align:top'>
                    <label><input id='item_not_completed_option' type='radio' checked onchange='app.updateItemComplete(this)' name='item_complete' value=''>Not completed</label>
                    <span id='locCompleteOptions'></span>
                </td></tr>
                <tr style='display:none' id='locCannotUncompleteMessage'><td colspan='2' style='color:brown'>One or more items depending on this are already completed.</td></tr>
            </table>
            <hr>
            </span>
            <span id='itemDetailEditor' style='display:none;'>
            <table class='form'>
                <tr><th>&nbsp;
                    <span class='anchor' onclick='app.askToDeleteItem()' style='color:red;font-weight:bold'>&times;</span>
                    Item&nbsp;Title:</th><td>
                    <input onkeyup='app.updateItemTitle(this)' name='det_item_title'>
                    <button style='font-size:.7em' onclick='app.askToAddNewItem()'>Add Item</button>
                </td></tr>
                <tr><th>Shape:</th><td><select onchange='app.updateItemShape(this)' id='item_shape' name='item_shape'>
                        <option value='box'>Box</option>
                        <option value='circle'>Circle</option>
                        <option value='diamond'>Diamond</option>
                        <option value='stop'>Stop</option>
                        <option value='pill'>Pill</option>
                    </select>
                    </td>
                </tr>
                <tr><th style='vertical-align:top'>Done&nbsp;Codes:</th><td style='font-size:.8em'>(listed below)</td>
                <tr><td colspan='2' style='padding-left:2em;'>
                    <table id='tbl_done_codes'><tr>
                        <th style='width:55px'>Code</th>
                        <th>Value <button style='font-size:.7em;' onclick='app.editDoneCode()'>add</button></th>
                    </tr></table>
                </td></tr>
                <tr><td colspan='2'>
                    <table style='width:400px'>
                        <td style='vertical-align:top;'>
                            <span style='color:navy;'>Blocked By...</span>
                            <button style='font-size:.7em;' onclick='app.askToAddLink("blockby")'>Add</button>
                            <span id='locBlockedByList'></span>
                        </td>
                        <td style='width:50%; vertical-align:top;'>
                            <span style='color:navy;'>Blocking...</span>
                            <button style='font-size:.7em;' onclick='app.askToAddLink("blocks")'>Add</button>
                            <span id='locBlocksList'></span>
                        </td>
                    </table>
                </td></tr>
                <tr><td colspan='2'><hr></td></tr>
                <tr><th style='vertical-align:top'>Blocked&nbsp;till:</th><td style='vertical-align:top'>
                    <label><input id='item_block_type_any' type='radio' onchange='app.updateBlockType(this)' name='item_block_type' value='any'>Any</label>
                    <label><input id='item_block_type_all' type='radio' checked onchange='app.updateBlockType(this)' name='item_block_type' value='all'>All</label>
                    &nbsp;'Blocked Bys' are done
                </td></tr>
            </table>
            <hr>
        </span>
        </form>
        <form class='popForm' onsubmit='return false;' id='locSaveLocal' style='display:none'>
            Copy from the box below to send to another user:<br/>
            <textarea id='locSaveToClipboard' readonly style='font-size:5pt;width:100%;height:20em;'></textarea>
            &nbsp; ... <button onclick='app.downloadFile()'>Save to File</button>
            or <button onclick='app.cancelAction()'>Cancel</button>
        </form>
        <form class='popForm' onsubmit='return false;' id='locLoadLocal' style='display:none'>
            Select from the list to load it...<br/>
            <select style='width:100%' id='selLoadLocal' onchange='app.loadLocal()'>
                <option value='1'>1.</option>
                <option value='2'>2.</option>
                <option value='3'>3.</option>
                <option value='4'>4.</option>
                <option value='5'>5.</option>
                <option value='6'>6.</option>
                <option value='7'>7.</option>
                <option value='8'>8.</option>
                <option value='9'>9.</option>
                <option value='10'>10.</option>
            </select> 
            <br/>
            <br/>Drag a .flow file into the box below or paste the contents from another browser:<br/>
            <textarea id='locLoadFromClipboard' style='font-size:5pt;width:100%;height:20em;'></textarea><br/>
            &nbsp; ... <button onclick='app.loadFromTextbox()'>Load</button>,
            <button onclick='app.askToStartNew()'>Clear&hellip;</button>,
            <button onclick='app.askToSaveFlow()'>Save&hellip;</button>
            or <button onclick='app.cancelAction()'>Cancel</button>
        </form>
        <form class='popForm' onsubmit='return false;' id='locConfirmDelete' style='display:none'>
            &nbsp; ... <button onclick='app.cancelAction()'>Cancel</button>
            or <button onclick='app.confirmDeleteItem()'>Confirm Delete</button>
        </form>
        <form class='popForm' onsubmit='return false;' id='locConfirmRemoveLink' style='display:none'>
            <span id='locConfirmRemoveLinkMessage'></span><br/>
            &nbsp; ... <button onclick='app.cancelAction();'>Cancel</button>
            or <button onclick='app.confirmRemoveLink()'>Confirm</button>
        </form>
        <form class='popForm' onsubmit='return false;' id='locConfirmStartNew' style='display:none'>
            Be sure you have saved your work!!<br/>
            &nbsp; ... <button onclick='app.cancelAction();'>Cancel</button>
            or <button onclick='app.confirmStartNew()'>Clear and Start New</button>
        </form>
        <form class='popForm' onsubmit='return false;' id='locConfirmAddLink' style='display:none'>
            <span id='locConfirmAddLinkMessage'></span><br/>
            &nbsp; ... <button onclick='app.cancelAction();'>Cancel</button>
        </form>
        <form class='popForm' onsubmit='return false;' id='locConfirmAddItem' style='display:none'>
            Name of new item: <input id='txtNewItemName' placeholder='New'><br/>
            Pick new item shape: <select id='selNewItemShape'>
                <option value='box'>Box</option>
                <option value='circle'>Circle</option>
                <option value='diamond'>Diamond</option>
                <option value='stop'>Stop</option>
                <option value='pill'>Pill</option>
            </select><br/>
            Click on an open spot to create the new item there<br/>
            &nbsp; ... <button onclick='app.cancelAction();'>Cancel</button>
        </form>
        <form class='popForm' onsubmit='return false;' id='locEditDoneCode' style='display:none'>
            Set code and value for this 'done' option. Setting the code to blank will remove it.<br/>
            &nbsp; ... Code: <input id='txtEditDoneCode' size='4'><br/>
            &nbsp; ... Vaue: <input id='txtEditDoneValue' size='20'><br/>
            &nbsp; ... <button onclick='app.setDoneCode()'>Save</button>
            or <button onclick='app.cancelAction();'>Cancel</button>
        </form>
        <form class='popForm' onsubmit='return false;' id='locEditLink' style='display:none'>
            <span id='locEditLinkMessage'></span><br/>
            <table style='margin-left:2em' id='tbl_link_codes'><tr>
                <th style='width:1.5em;'>&nbsp;</th>
                <th style='width:55px'>Code</th>
                <th>Value</th>
            </tr></table>
            &nbsp; ... <button onclick='app.saveEditedLink()'>Save</button>
            or <button onclick='app.cancelAction();'>Cancel</button>
        </form>
        <div id='locInstructionsWorking' style='display:none; padding:.3em'>
            You are in <b class='anchor' onclick='app.toggleMode()'>work</b> mode. 
                To change modes at any time, click on the link
                at the top right of this screen.
            <p>In <b>work</b> mode, you can only set items as complete or incomplete. 
                Click an item in the diagram and then select the status in
                this area when the choices are displayed.
            </p>
        </div>
        <div id='locInstructionsDesign' style='display:none; padding:.3em'>
            You are in <b class='anchor' onclick='app.toggleMode()'>design</b> mode. 
                To change modes at any time, click on the link
                at the top right of this screen.
            <p>In <b>design</b> mode, you edit the items in the workflow and move the items
                around on the screen for a visually pleasing 'flow'.
            </p>

            <button onclick='app.askToAddNewItem()'>Add Item</button>

        </div>
        <div id='messageContainer'>
            <span id='locToastMessage'></span>
        </div>

    </div>
</body>
</html>
